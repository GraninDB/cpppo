#! /usr/bin/env python

# 
# Poll a PowerFlex 750 series at IP (or DNS name) "<hostname>" (default: localhost)
# 
#     python -m cpppo.server.enip.poll_example <hostname>
# 
# To start a simulator on localhost suitable for polling:
# 
#     python -m cpppo.server.enip.poll_test
# 

import logging
import sys
import time
import threading

import cpppo
cpppo.log_cfg['level'] = logging.DETAIL
logging.basicConfig( **cpppo.log_cfg )

from cpppo.server.enip import poll
#from cpppo.server.enip.get_attribute import proxy_simple as device # MicroLogix
from cpppo.server.enip.get_attribute import proxy_connected as device # ControlLogix
#from cpppo.server.enip.ab import powerflex_750_series as device # PowerFlex 750

# Device IP in 1st arg, or 'localhost' (run: python -m cpppo.server.enip.poll_test)
hostname			= sys.argv[1] if len( sys.argv ) > 1 else 'localhost'

# Parameters valid for device; for *Logix, others, try:
params				= []
params			       += [('@1/1/1','INT'),('@1/1/7', ('SSTRING', 'USINT'))]
#params			       += [ "A63FGRDT", "T455ADT", "blah_de_blah" ]
params			       += [
    "ITESTIP",
    "ITESTOP",
    "TEST_TAG_01",
    "TEST_TAG_02",
    "TEST_TAG_03",
    "TEST_TAG_04",
    "TEST_TAG_05",
    "TEST_TAG_06",
    "TEST_TAG_07",
    "TEST_TAG_08",
    "TEST_TAG_09",
    "TEST_TAG_10",
    "TEST_TAG_11",
    "TEST_TAG_12",
    "TEST_TAG_13",
    "TEST_TAG_14",
    "TEST_TAG_15",
    ]
params_other = []
params_other		       += [
	"a14tr",
	"a26fg1_a",
	"a26fl2sa",
	"a26gg25amv",
	"a26gg25amvc",
	"a26gg25bmv",
	"a26gg25bmvc",
	"a26gg25cmv",
	"a26gg25cmvc",
	"a26gg31amv",
	"a26gg31amvc",
	"a26gg31bmv",
	"a26gg31bmvc",
	"a26gg455_01amv",
	"a26gg455_01amvc",
	"a26gg455_02amv",
	"a26gg455_02amvc",
	"a26gg455_03amv",
	"a26gg455_03amvc",
	"a26gg455_04amv",
	"a26gg455_04amvc",
	"a26gg455_05amv",
	"a26gg455_05amvc",
	"a26gg455_06amv",
	"a26gg455_06amvc",
	"a26gg455_07amv",
	"a26gg455_07amvc",
	"a26gg455_08amv",

    "blah_de_blah",

	"a26gg455_08amvc",
	"a26gg455_09amv",
	"a26gg455_09amvc",
	"a26gg455_10amv",
	"a26gg455_10amvc",
	"a26gg455_11amv",
	"a26gg455_11amvc",
	"a26gg455_12amv",
	"a26gg455_12amvc",
	"a26gg455_13amv",
	"a26gg455_13amvc",
	"a26gg455_14amv",
	"a26gg455_14amvc",
	"a26gg455_15amv",
	"a26gg455_15amvc",
	"a26gg455_16amv",
	"a26gg455_16amvc",
	"a26gg455_17amv",
	"a26gg455_17amvc",
	"a26gg455bamv",
	"a26gg455bamvc",
	"a26gg455camv",
	"a26gg455camvc",
	"a26ia1_a",
	"a26lf1_a",
	"a26pnl1",
	"a26pnl2",
	"a26pnlmem",
	"a26qggs_a",
	"a26qggs_b",
	"a63fgmt",
	"a63fgrdt",
	"a63fl2r",
	"a63fl2s",
	"A63GGBA",
	"a63ggcd",
	"a63jlfmv",
	"a63jqgbt",
	"a63lf2",
	"a63qgcs",
	"a63qgght2",
	"a63qgjcv",
	"a63srm",
	"a65fclssp",
	"a65fcpfb",
	"a65fcucp",
	"a71qgt",
	"a75fgmf",
	"a75fl1mf",
	"a75fl2mf",
	"a75ggigvf1",
	"a75ggigvf2",
	"a75ggigvf3",
	"a75qgcvf",
	"a80cent_1",
	"a80cent_2",
	"a80qgg",
	"a99gg1a",
	"a99gg1b",
	"a99gg2a",
	"a99gg2b",
	"a99st",
	"a99ta",
	"a99tb",
	"dasisplcb",
	"dasisplcmf",
	"di23gas",
	"di23liq1",
	"di23liq2",
	"diack",
	"diactbyp",
	"diactpre",
	"diactsch",
	"dibrkcls",
	"diclock",
	"didsd",
	"diengmod",
	"difuel",
	"digasbof",
	"digasbrf",
	"digasbuf",
	"digasbvrf",
	"digascf",
	"digasdof",
	"digasdsf",
	"digasecf",
	"digasferf",
	"digashlsf",
	"digashtf",
	"digasl1",
	"digasl2",
	"digasm15vf",
	"digasmof",
	"digasmtf",
	"digasnbv",
	"digasp15vf",
	"digaspef",
	"digasposhf",
	"digasprehf",
	"digasrf",
	"digasuvwf",
	"digenfsf",
	"dihbsis",
	"diisoc",
	"dil1enfsf",
	"dil2enfsf",
	"dilchkst",
	"diliq1bof",
	"diliq1brf",
	"diliq1buf",
	"diliq1bvrf",
	"diliq1cf",
	"diliq1dof",
	"diliq1dsf",
	"diliq1ecf",
	"diliq1ferf",
	"diliq1hlsf",
	"diliq1htf",
	"diliq1m15vf",
	"diliq1mof",
	"diliq1mtf",
	"diliq1nbv",
	"diliq1p15vf",
	"diliq1pef",
	"diliq1poshf",
	"diliq1prehf",
	"diliq1rf",
	"diliq1uvwf",
	"diliq2bof",
	"diliq2brf",
	"diliq2buf",
	"diliq2bvrf",
	"diliq2cf",
	"diliq2dof",
	"diliq2dsf",
	"diliq2ecf",
	"diliq2ferf",
	"diliq2hlsf",
	"diliq2htf",
	"diliq2m15vf",
	"diliq2mof",
	"diliq2mtf",
	"diliq2nbv",
	"diliq2p15vf",
	"diliq2pef",
	"diliq2poshf",
	"diliq2prehf",
	"diliq2rf",
	"diliq2uvwf",
	"diload",
	"dilocsv1",
	"dilocsv2",
	"dils",
	"dimgbrkcls",
	"din3lwr",
	"din3med",
	"din3osen",
	"din3ras",
	"din3rem",
	"dipeak",
	"diprewet",
	"diqgdmr1",
	"diqgdmr2",
	"diqgdmr3",
	"dirst",
	"dirstd",
	"dirstf",
	"distr",
	"ditl2",
	"diwnd",
	"dizoerr",
	"dplin",
	"dssis",
	"dxfuel",
	"h1in",
	"hsmpin",
	"i23cen",
	"i23fl2m",
	"i23lf",
	"i33qgsv1c",
	"i33qgsv2c",
	"i3clk",
	"i41bkrc3",
	"i52gngcbc",
	"i65engmod",
	"i65fcdreset",
	"i65fcdsd",
	"i65fcfreset",
	"i65fcfuel",
	"i65fcgl1",
	"i65fcgl2",
	"i65fcisoc",
	"i65fclackn",
	"i65fcload",
	"i65fclower",
	"i65fclreset",
	"i65fcls",
	"i65fcote",
	"i65fcpeak",
	"i65fcprewet",
	"i65fcptmr",
	"i65fcraise",
	"i65fcremote",
	"i65fcstart",
	"i65fcwm",
	"i65leak",
	"i6bypx",
	"i6pwtx",
	"i6schx",
	"i86fl2m",
	"i86lfmc",
	"i86lx",
	"i86mc1",
	"i86qgcv",
	"l41",
	"lodpin",
	"lsin",
	"n3remin",
	"olvlin",
	"p30gg",
	"pdpqovin",
	"pgegg",
	"pgigg",
	"pl1igg",
	"pl2igg",
	"pl2rgg",
	"powin",
	"qqin",
	"rhomtr",
	"t1",
	"tc25a",
	"tc25b",
	"tc25c",
	"tc31a",
	"tc31b",
	"tc455",
	"tc455",
	"tc455a1",
	"tc455b1",
	"tc455c1",
	"tc455d1",
	"tc455e1",
	"tc455f1",
	"tc455g1",
	"tc455h1",
	"tc455j1",
	"tc455k1",
	"tc455l1",
	"tc455m1",
	"tc455n1",
	"tc455p1",
	"tc455r1",
	"tc455s1",
	"tc455t1",
	"tfl1",
	"tfl2",
	"tg",
	"tl1a",
	"tl1b",
	"ucphsin",
	"wgmtrin",
	"zgact",
	"zl1act",
	"zl2act",
	"zomain",
	"zvvain",
	"zvvbin",
	"zvvcin",
	"A26E10C",
	"A26E1_17A",
	"A26E1_17B",
	"A26E11C",
	"A26E12C",
	"A26E13C",
	"A26E14C",
	"A26E15C",
	"A26E16C",
	"A26E17C",
	"A26E1C",
	"A26E2C",
	"A26E3C",
	"A26E4C",
	"A26E5C",
	"A26E6C",
	"A26E7C",
	"A26E8C",
	"A26E9C",
	"A26FG1_A",
	"A26GG455_04AMVC",
	"A26GG455_11AMV",
	"A26GG455_11AMVC",
	"A26GG455_17AMV",
	"A26GG455CAMV",
	"A26IA1_A",
	"A26LF1_A",
	"A26QGGS_A",
	"A26QGGS_B",
	"A63FGMT",
	"A63FGRDT",
	"A63GGCD",
	"A63JLFMV",
	"A63JQGBT",
	"A63LF2",
	"A63QGGHT2",
	"A75FGMF",
	"A75GGIGVF1",
	"A75GGIGVF2",
	"A80CENT_1",
	"A80CENT_2",
	"A80QGG",
	"A99GG1A",
	"A99GG1B",
	"A99GG2A",
	"A99GG2B",
	"A99ST",
	"A99TA",
	"A99TB",
	"ACT01",
	"ACT02",
	"ACT03",
	"ACT04",
	"ACT05",
	"ACT06",
	"ACT07",
	"ACT08",
	"ACT09",
	"ACT10",
	"ACT100",
	"ACT101",
	"ACT11",
	"ACT111",
	"ACT112",
	"ACT115",
	"ACT116",
	"ACT117",
	"ACT12",
	"ACT13",
	"ACT14",
	"ACT15",
	"ACT155",
	"ACT156",
	"ACT157",
	"ACT158",
	"ACT159",
	"ACT16",
	"ACT164",
	"ACT165",
	"ACT166",
	"ACT167",
	"ACT168",
	"ACT169",
	"ACT17",
	"ACT173",
	"ACT18",
	"ACT182",
	"ACT183",
	"ACT184",
	"ACT19",
	"ACT20",
	"ACT204",
	"ACT21",
	"ACT22",
	"ACT23",
	"ACT24",
	"ACT25",
	"ACT26",
	"ACT27",
	"ACT28",
	"ACT29",
	"ACT30",
	"ACT31",
	"ACT32",
	"ACT33",
	"ACT34",
	"ACT35",
	"ACT36",
	"ACT37",
	"ACT38",
	"ACT39",
	"ACT40",
	"ACT41",
	"ACT42",
	"ACT43",
	"ACT44",
	"ACT45",
	"ACT46",
	"ACT47",
	"ACT48",
	"ACT49",
	"ACT50",
	"ACT51",
	"ACT52",
	"ACT53",
	"ACT54",
	"ACT55",
	"ACT56",
	"ACT57",
	"ACT58",
	"ACT59",
	"ACT60",
	"ACT61",
	"ACT62",
	"ACT63",
	"ACT64",
	"ACT97",
	"ACT98",
	"ACT99",
	"BOV1MANUALSTROKE_HMI",
	"BOV2MANUALSTROKE_HMI",
	"BOVMANUALSTROKE_HMI",
	"C75GGIGVC",
	"C75QGGC",
	"DATE_TIME",
	"DLACT01",
	"DLACT02",
	"DLACT03",
	"DLACT04",
	"DLACT05",
	"DLACT06",
	"DLACT07",
	"DLACT08",
	"DLACT09",
	"DLACT10",
	"DLACT11",
	"DLACT12",
	"DLACT13",
	"DLACT14",
	"DLACT15",
	"DLACT16",
	"DLISS01",
	"DLISS02",
	"DLISS03",
	"DLISS04",
	"DLISS05",
	"DLISS06",
	"DLISS07",
	"DLISS08",
	"DLISS09",
	"DLISS10",
	"DLISS11",
	"DLISS12",
	"DLISS13",
	"DLISS14",
	"DLISS15",
	"DLISS16",
	"DLSSS01",
	"DLSSS02",
	"DLSSS03",
	"DLSSS04",
	"DLSSS05",
	"DLSSS06",
	"DLSSS07",
	"DLSSS08",
	"DLSSS09",
	"DLSSS10",
	"DLSSS11",
	"DLSSS12",
	"DLSSS13",
	"DLSSS14",
	"DLSSS15",
	"DLSSS16",
	"DPCMPM",
	"DPHHX1",
	"DPHHX2",
	"DPHHX3",
	"DPHHX4",
	"DPHHX5",
	"DPHHY1",
	"DPHHY2",
	"DPHHY3",
	"DPHHY4",
	"DPHHY5",
	"DPHX1",
	"DPHX2",
	"DPHX3",
	"DPHX4",
	"DPHX5",
	"DPHY1",
	"DPHY2",
	"DPHY3",
	"DPHY4",
	"DPHY5",
	"DPLLX1",
	"DPLLX2",
	"DPLLX3",
	"DPLLY1",
	"DPLLY2",
	"DPLLY3",
	"DPLX1",
	"DPLX2",
	"DPLX3",
	"DPLY1",
	"DPLY2",
	"DPLY3",
	"ECS_FO.DATA",
	"EMV_FO.DATA",
	"FTTUNE_HMI",
	"GMVMANUALSTROKE_HMI",
	"H1ACTM",
	"H1LLSETM",
	"H1LSETM",
	"I23CEN",
	"I23LF",
	"I6BYPX",
	"I6PWTX",
	"I6SCHX",
	"I86LFMC",
	"I86MC1",
	"IGVMANUALSTROKE_HMI",
	"ISS01",
	"ISS02",
	"ISS03",
	"ISS04",
	"ISS05",
	"ISS06",
	"ISS07",
	"ISS08",
	"ISS09",
	"ISS10",
	"ISS11",
	"ISS12",
	"ISS13",
	"ISS14",
	"ISS15",
	"ISS16",
	"ISS17",
	"ISS18",
	"ISS19",
	"ISS20",
	"ISS21",
	"ISS22",
	"ISS23",
	"ISS24",
	"ISS25",
	"ISS26",
	"ISS27",
	"ISS28",
	"ISS29",
	"ISS30",
	"ISS31",
	"ISS32",
	"ISS33",
	"ISS34",
	"ISS35",
	"ISS36",
	"ISS37",
	"ISS38",
	"ISS39",
	"ISS40",
	"ISS41",
	"ISS42",
	"ISS43",
	"ISS44",
	"ISS45",
	"ISS46",
	"ISS47",
	"ISS48",
	"ISS49",
	"ISS50",
	"ISS51",
	"ISS52",
	"ISS53",
	"ISS54",
	"ISS55",
	"ISS56",
	"ISS57",
	"ISS58",
	"ISS59",
	"ISS60",
	"ISS61",
	"ISS62",
	"ISS63",
	"ISS64",
	"ITESTIP",
	"ITESTOP",
	"L1ACTC",
	"L1HHSETC",
	"L1HSETC",
	"LAA65UC001",
	"LAA65UC002",
	"LAA65UC003",
	"LAA65UC004",
	"LAA65UC005",
	"LAA65UC006",
	"LAA65UC007",
	"LAA65UC008",
	"LAA65UC009",
	"LAA65UC010",
	"LAA65UC011",
	"LAA65UC012",
	"LAA65UC013",
	"LAA65UC014",
	"LAA65UC015",
	"LAA65UC016",
	"LAA65UC017",
	"LAA65UC018",
	"LAA65UC019",
	"LAA65UC020",
	"LAA65UC021",
	"LAA65UC022",
	"LAA65UC023",
	"LAA65UC024",
	"LAA65UC025",
	"LAA65UC026",
	"LAA65UC027",
	"LAA65UC028",
	"LAA65UC029",
	"LAA65UC030",
	"LAA65UC031",
	"LAA65UC032",
	"LAA65UC033",
	"LAA65UC034",
	"LAA65UC035",
	"LAA65UC036",
	"LAA65UC037",
	"LAA65UC038",
	"LAA65UC039",
	"LAA65UC040",
	"LAA65UC041",
	"LAA65UC042",
	"LAA65UC043",
	"LAA65UC044",
	"LAA65UC045",
	"LAA65UC046",
	"LAA65UC047",
	"LAA65UC048",
	"LAA65UC049",
	"LAA65UC050",
	"LAA65UC051",
	"LAA65UC052",
	"LAA65UC053",
	"LAA65UC054",
	"LAA65UC055",
	"LAA65UC056",
	"LAA65UC057",
	"LAA65UC058",
	"LAA65UC059",
	"LAA65UC060",
	"LAA65UC061",
	"LAA65UC062",
	"LAA65UC063",
	"LAA65UC064",
	"LAA65UC065",
	"LAA65UC066",
	"LAA65UC067",
	"LAA65UC068",
	"LAA65UC069",
	"LAA65UC070",
	"LAA65UC071",
	"LAA65UC072",
	"LAA65UC073",
	"LAA65UC074",
	"LAA65UC075",
	"LAA65UC076",
	"LAA65UC077",
	"LAA65UC078",
	"LAA65UC079",
	"LAA65UC080",
	"LAA65UC081",
	"LAA65UC082",
	"LAA65UC083",
	"LAA65UC084",
	"LAA65UC085",
	"LAA65UC086",
	"LAA65UC087",
	"LAA65UC088",
	"LAA65UC089",
	"LAA65UC090",
	"LAA65UC091",
	"LAA65UC092",
	"LAA65UC093",
	"LAA65UC094",
	"LAA65UC095",
	"LCC65UC001",
	"LCC65UC002",
	"LCC65UC003",
	"LCC65UC004",
	"LCC65UC005",
	"LCC65UC006",
	"LCC65UC007",
	"LCC65UC008",
	"LCC65UC009",
	"LCC65UC010",
	"LCC65UC011",
	"LCC65UC012",
	"LCC65UC013",
	"LCC65UC014",
	"LCC65UC015",
	"LEE65UC001",
	"LEE65UC002",
	"LEE65UC003",
	"LEE65UC004",
	"LEE65UC005",
	"LEE65UC006",
	"LEE65UC007",
	"LEE65UC008",
	"LEE65UC009",
	"LEE65UC010",
	"LEE65UC011",
	"LEE65UC012",
	"LEE65UC013",
	"LEE65UC014",
	"LEE65UC015",
	"LEE65UC016",
	"LEE65UC017",
	"LEE65UC018",
	"LEE65UC019",
	"LEE65UC020",
	"LEE65UC021",
	"LEE65UC022",
	"LEE65UC023",
	"LEE65UC024",
	"LEE65UC025",
	"LEE65UC026",
	"LEE65UC027",
	"LEE65UC028",
	"LEE65UC029",
	"LEE65UC030",
	"LEE65UC031",
	"LEE65UC032",
	"LEE65UC033",
	"LEE65UC034",
	"LEE65UC035",
	"LEE65UC036",
	"LEE65UC037",
	"LEE65UC038",
	"LEE65UC039",
	"LEE65UC040",
	"LEE65UC041",
	"LEE65UC042",
	"LEE65UC043",
	"LEE65UC044",
	"LEE65UC045",
	"LEE65UC046",
	"LEE65UC047",
	"LEE65UC048",
	"LEE65UC049",
	"LEE65UC050",
	"LEE65UC051",
	"LEE65UC052",
	"LEE65UC053",
	"LEE65UC054",
	"LEE65UC055",
	"LEE65UC056",
	"LEE65UC057",
	"LEE65UC058",
	"LEE65UC059",
	"LEE65UC060",
	"LEE65UC061",
	"LEE65UC062",
	"LEE65UC063",
	"LEE65UC064",
	"LEE65UC065",
	"LEE65UC066",
	"LEE65UC067",
	"LEE65UC068",
	"LEE65UC069",
	"LEE65UC070",
	"LEE65UC071",
	"LEE65UC072",
	"LEE65UC073",
	"LEE65UC074",
	"LEE65UC075",
	"LEE65UC076",
	"LEE65UC077",
	"LEE65UC078",
	"LEE65UC079",
	"LFF26E10C",
	"LFF26E1_17A",
	"LFF26E1_17B",
	"LFF26E11C",
	"LFF26E12C",
	"LFF26E13C",
	"LFF26E14C",
	"LFF26E15C",
	"LFF26E16C",
	"LFF26E17C",
	"LFF26E1C",
	"LFF26E2C",
	"LFF26E3C",
	"LFF26E4C",
	"LFF26E5C",
	"LFF26E6C",
	"LFF26E7C",
	"LFF26E8C",
	"LFF26E9C",
	"LFF26FG1_A",
	"LFF26IA1_A",
	"LFF26LF1_A",
	"LFF26QGGS_A",
	"LFF26QGGS_B",
	"LFF63FGMT",
	"LFF63FGRDT",
	"LFF63GGCD",
	"LFF63JLFMV",
	"LFF63JQGBT",
	"LFF63LF2",
	"LFF63QGGHT2",
	"LFF75GGIGVF1",
	"LFF75GGIGVF2",
	"LFF75GGIGVF3",
	"LFF80CENT1",
	"LFF80CENT2",
	"LFF80QGG",
	"LFF99GG1A",
	"LFF99GG1B",
	"LFF99GG2A",
	"LFF99GG2B",
	"LFF99ST",
	"LFF99TA",
	"LFF99TB",
	"LIQ1MVMANUALSTROKE_HMI",
	"LIQ2MVMANUALSTROKE_HMI",
	"LSD65UC001",
	"LSD65UC002",
	"LSD65UC003",
	"LSD65UC004",
	"LSD65UC005",
	"LSD65UC006",
	"LSD65UC007",
	"LSD65UC008",
	"LSD65UC009",
	"LSD65UC010",
	"LSD65UC011",
	"LSD65UC012",
	"LSD65UC013",
	"LSD65UC014",
	"LSD65UC015",
	"LSD65UC016",
	"LSD65UC017",
	"LSD65UC018",
	"LSD65UC019",
	"LSD65UC020",
	"LSD65UC021",
	"LSD65UC022",
	"LSD65UC023",
	"LSD65UC024",
	"LSD65UC025",
	"LSD65UC026",
	"LSD65UC027",
	"LSD65UC028",
	"LSD65UC029",
	"LSD65UC030",
	"LSD65UC031",
	"LSD65UC032",
	"LSD65UC033",
	"LSD65UC034",
	"LSD65UC035",
	"LSD65UC036",
	"LSD65UC037",
	"LSD65UC038",
	"LSD65UC039",
	"LSD65UC040",
	"LSD65UC041",
	"LSD65UC042",
	"LSD65UC043",
	"LSD65UC044",
	"LSD65UC045",
	"LSD65UC046",
	"LSD65UC047",
	"LSD65UC048",
	"LSD65UC049",
	"LSD65UC050",
	"LSD65UC051",
	"LSD65UC052",
	"LSD65UC053",
	"LSD65UC054",
	"LSD65UC055",
	"LSD65UC056",
	"LSD65UC057",
	"LSD65UC058",
	"LSD65UC059",
	"LSD65UC060",
	"LSD65UC061",
	"LSD65UC062",
	"LSD65UC063",
	"LSD65UC064",
	"LSS65UC001",
	"LSS65UC002",
	"LSS65UC003",
	"LSS65UC004",
	"LSS65UC005",
	"LSS65UC006",
	"LSS65UC007",
	"LSS65UC008",
	"LSS65UC009",
	"LSS65UC010",
	"LSS65UC011",
	"LSS65UC012",
	"LSS65UC013",
	"LSS65UC014",
	"LSS65UC015",
	"LSS65UC016",
	"LSS65UC017",
	"LSS65UC018",
	"LSS65UC019",
	"LSS65UC020",
	"LSS65UC021",
	"LSS65UC022",
	"LSS65UC023",
	"LSS65UC024",
	"LSS65UC025",
	"LSS65UC026",
	"LSS65UC027",
	"LSS65UC028",
	"LSS65UC029",
	"LSS65UC030",
	"LSS65UC031",
	"LSS65UC032",
	"LSS65UC033",
	"LSS65UC034",
	"LSS65UC035",
	"LSS65UC036",
	"LSS65UC037",
	"LSS65UC038",
	"LSS65UC039",
	"LSS65UC040",
	"LSS65UC041",
	"LSS65UC042",
	"LSS65UC043",
	"LSS65UC044",
	"LSS65UC045",
	"LSS65UC046",
	"LSS65UC047",
	"LSS65UC048",
	"LSS65UC049",
	"LSS65UC050",
	"LSS65UC051",
	"LSS65UC052",
	"LSS65UC053",
	"LSS65UC054",
	"LSS65UC055",
	"LSS65UC056",
	"LSS65UC057",
	"LSS65UC058",
	"LSS65UC059",
	"LSS65UC060",
	"LSS65UC061",
	"LSS65UC062",
	"LSS65UC063",
	"LSS65UC064",
	"LSS65UC065",
	"LSS65UC066",
	"LSS65UC067",
	"LSS65UC068",
	"LSS65UC069",
	"LSS65UC070",
	"LSS65UC071",
	"LSS65UC072",
	"LSS65UC073",
	"LSS65UC074",
	"LSS65UC075",
	"LSS65UC076",
	"LSS65UC077",
	"LSS65UC078",
	"LSS65UC079",
	"LSS65UC080",
	"LSS65UC081",
	"LSS65UC082",
	"LSS65UC083",
	"LSS65UC084",
	"LSS65UC085",
	"LSS65UC086",
	"LSS65UC087",
	"LSS65UC088",
	"LSS65UC089",
	"LSS65UC090",
	"LSS65UC091",
	"LSS65UC092",
	"LSS65UC093",
	"LSS65UC094",
	"LSS65UC095",
	"LSS65UC096",
	"LSS65UC097",
	"LSS65UC098",
	"LSS65UC099",
	"LSS65UC100",
	"LSS65UC101",
	"LSS65UC102",
	"LSS65UC103",
	"LSS65UC104",
	"LSS65UC105",
	"LSS65UC106",
	"LSS65UC107",
	"LSS65UC108",
	"LSS65UC109",
	"LSS65UC110",
	"LSS65UC111",
	"LSS65UC112",
	"LSS65UC113",
	"LSS65UC114",
	"LSS65UC115",
	"LSS65UC116",
	"LSS65UC117",
	"LSS65UC118",
	"LSS65UC119",
	"LSS65UC120",
	"LSS65UC121",
	"LSS65UC122",
	"LSS65UC123",
	"LSS65UC124",
	"LSS65UC125",
	"LSS65UC126",
	"LSS65UC127",
	"N1USPD",
	"N3OSPD",
	"O20FR",
	"O20GGB",
	"O3BYPX",
	"O3LFMCEX",
	"O3MCEX",
	"O3PWTX",
	"O3SCHX",
	"O80CENT_4",
	"QQCMPLPM",
	"QQSET",
	"SSS01",
	"SSS02",
	"SSS03",
	"SSS04",
	"SSS05",
	"SSS06",
	"SSS07",
	"SSS08",
	"SSS09",
	"SSS10",
	"SSS11",
	"SSS12",
	"SSS13",
	"SSS14",
	"SSS15",
	"SSS16",
	"SSS17",
	"SSS18",
	"SSS19",
	"SSS21",
	"SSS22",
	"SSS23",
	"SSS24",
	"SSS25",
	"SSS26",
	"SSS27",
	"SSS28",
	"SSS29",
	"SSS30",
	"SSS31",
	"SSS32",
	"SSS33",
	"SSS34",
	"SSS35",
	"SSS36",
	"SSS37",
	"SSS38",
	"SSS39",
	"SSS40",
	"SSS41",
	"SSS42",
	"SSS43",
	"SSS44",
	"SSS45",
	"SSS46",
	"SSS47",
	"SSS48",
	"SSS49",
	"SSS50",
	"SSS51",
	"SSS52",
	"SSS53",
	"SSS54",
	"SSS55",
	"SSS56",
	"SSS57",
	"SSS58",
	"SSS59",
	"SSS60",
	"SSS61",
	"SSS62",
	"SSS63",
	"SSS64",
	"T455ADT",
	"T455DTA",
	"T455DTB",
	"T455DTC",
	"T455DTD",
	"T455DTE",
	"T455DTF",
	"T455DTG",
	"T455DTH",
	"T455DTJ",
	"T455DTK",
	"T455DTL",
	"T455DTM",
	"T455DTN",
	"T455DTP",
	"T455DTR",
	"T455DTS",
	"T455DTT",
	"T455OTA",
	"T455OTC",
	"TC455",
	"TGABSSET",
	"TGLLSET",
	"TGLSET",
	"TL1HA",
	"TL1HS",
	"TUNING_GAS_C1",
	"TUNING_GAS_C2",
	"TUNING_GAS_C3",
	"TUNING_GAS_C4",
	"TUNING_GAS_C5",
	"TUNING_GAS_C6",
	"TUNING_GAS_CO2",
	"TUNING_GAS_IC4",
	"TUNING_GAS_IC5",
	"TUNING_GAS_N2",
	"ZGACT",
	"ZL1ACT",
    ]

def failure( exc ):
    failure.string.append( str(exc) )
failure.string			= [] # [ <exc>, ... ]

def process( par, val ):
    process.values[par]		= val
process.done			= False
process.values			= {} # { <parameter>: <value>, ... }

poller				= threading.Thread(
    target=poll.poll, kwargs={
        'proxy_class':  device,
        'multiple':	500,
        'depth':	0,
        'address': 	(hostname, 44818),
        'cycle':	1.0,
        'timeout':	0.5,
        'process':	process,
        'failure':	failure,
        'params':	params,
    })
poller.start()

# Monitor the process.values {} and failure.string [] (updated in another Thread)
try:
    while True:
        while process.values:
            par,val		= process.values.popitem()
            print( "%s: %16s == %r" % ( time.ctime(), par, val ))
        while failure.string:
            exc			= failure.string.pop( 0 )
            print( "%s: %s" %( time.ctime(), exc ))
        time.sleep( .1 )
finally:
    process.done		= True
    poller.join()
